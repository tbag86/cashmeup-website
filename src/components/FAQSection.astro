---
export interface FAQItem {
  question: string;
  answer: string;
}

export interface Props {
  title?: string;
  subtitle?: string;
  faqs: FAQItem[];
  id?: string;
  schema?: boolean;
}

const {
  title = 'Frequently Asked Questions',
  subtitle,
  faqs,
  id = 'faq',
  schema = true,
} = Astro.props;

const faqSchema = schema ? {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: faqs.map((faq) => ({
    '@type': 'Question',
    name: faq.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: faq.answer,
    },
  })),
} : null;
---

<section class="section-padding section-alt" id={id}>
  <div class="container-wide">
    <div class="text-center max-w-2xl mx-auto mb-12">
      <h2 class="text-3xl md:text-4xl font-black text-[#1B2A4A] mb-4">{title}</h2>
      {subtitle && <p class="text-slate-600 text-lg">{subtitle}</p>}
    </div>

    <div class="max-w-3xl mx-auto space-y-3">
      {faqs.map((faq, index) => (
        <details class="bg-white rounded-xl border border-slate-100 shadow-sm overflow-hidden group">
          <summary class="flex items-center justify-between gap-4 px-6 py-5 cursor-pointer select-none list-none hover:bg-slate-50 transition-colors">
            <span class="font-semibold text-[#1B2A4A] pr-4 text-left">{faq.question}</span>
            <span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-100 group-open:bg-[#2D6B2D] flex items-center justify-center transition-colors" aria-hidden="true">
              <svg class="w-3 h-3 text-slate-500 group-open:text-white transition-all group-open:rotate-45" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4" />
              </svg>
            </span>
          </summary>
          <div class="px-6 pb-5 pt-2 text-slate-600 leading-relaxed border-t border-slate-50">
            <p set:html={faq.answer} />
          </div>
        </details>
      ))}
    </div>
  </div>
</section>

{faqSchema && (
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
)}
